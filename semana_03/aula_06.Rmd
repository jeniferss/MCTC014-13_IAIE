 ### Aula Prática 06

Exemplo perfumes 

```{r}

mu <- 60
sigma <- 10

mu_perfume <- 57
sigma_perfume <- 10

n <- 100
alfa <- 0.05

standard_error <- sigma / sqrt(n)

# Bicaudal
c(alfa / 2, 1 - alfa / 2)

critical <- qt( c(alfa / 2, 1 - alfa / 2), df= n - 1)
critical

critical_brute <- critical * standard_error + mu
critical_brute


# Simular amostra
samples <- rnorm(n)
samples <- samples * sigma_perfume + mu_perfume

xbar <- mean(samples)
if (xbar > min(critical_brute) & xbar < max(critical_brute)){
  print('Aceita Hipótese Nula sabendo que é incorreta')
  has_type_ii_error = TRUE
} else {
  print('Rejeita Hipótese Nula sabendo que é incorreta')
  has_type_ii_error = FALSE
}

has_type_ii_error

has_type_ii_error_list = rep(0, 10000)
for (i in 1:10000) {
  samples <- rnorm(n)
  samples <- samples * sigma_perfume + mu_perfume
  
  xbar <- mean(samples)
  if (xbar > min(critical_brute) & xbar < max(critical_brute)){
    has_type_ii_error_list[i] = 1
  } 
}

beta <- mean(has_type_ii_error_list)
power <- 1 - beta

beta
power

```
